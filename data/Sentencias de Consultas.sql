
-- Mostrar el dinero recolectado por servicios en cada habitacion durante el periodo de tiempo y en el año corrido

SELECT H.ID ID_HABITACION,SUM(P.COSTO* CS.CANTIDAD) CONSUMO
FROM HTA_CONSUMO_SERVICIO CS, HTA_RESERVA_HABITACION RH, HTA_HABITACION H, HTA_PRODUCTO P
WHERE RH.IDHABITACION = H.ID 
    AND RH.ID = CS.IDRESERVA
	AND CS.IDPRODUCTO = P.IDPRODUCTO
	AND RH.FECHAINICIO > 'FECHA INICIO'
    AND RH.FECHA FIN < 'FECHA FIN'
GROUP BY H.ID;

-- Mostrar los 20 servicios más populares

SELECT IDSERVICIO, COUNT(DISTINCT IDFACTURA)NUM_CONUMOS
FROM HTA_CONSUMO_SERVICIO 
WHERE RH.FECHAINICIO > 'FECHA INICIO'
    AND RH.FECHA FIN < 'FECHA FIN'
GROUP BY IDSERVICIO
ORDER BY COUNT(DISTINCT IDFACTURA) DESC,IDSERVICIO;

-- Mostrar el índice de ocupación de cada una de las habitaciones del hotel

SELECT H.ID, COUNT(RH.ID) NUM_RESERVAS
FROM HTA_RESERVA_HABITACION RH, HTA_HABITACION H
WHERE RH.IDHABITACION = H.ID 
    AND RH.FECHAINICIO > 'FECHA INICIO'
    AND RH.FECHA FIN < 'FECHA FIN'
GROUP BY H.ID
ORDER BY H.ID;

--Mostrar los servicios que cumplen con cierta característica

SELECT *
FROM HTA_SERVICIO S 
WHERE COSTO < 'COSTO'
	AND COSTO > 'COST0';

SELECT *
FROM HTA_SERVICIO S 
WHERE FECHAINICIO > 'FECHAINICIO'
	AND FECHAFIN < 'FECHAFIN';


-- Mostrar el consumo en HotelAndes por un usuario dado en un rango de fechas indicado

SELECT *
FROM HTA_CONSUMO_SERVICIO CS, HTA_RESERVA_HABITACION RH, HTA_CLIENTE C
WHERE RH.ID = CS.IDRESERVA
	AND RH.NUMDOCCLIENTE = C.NUMDOC
	AND RH.TIPODOCCLIENTE = C.TIPODOC
	AND RH.DIAENTRADA > 'FECHAINICIO'
	AND RH.DIASALIDA < 'FECHASALIDA'
	AND C.TIPODOC = 'TIPODOC'
	AND C.NUMDOC = 'NUMDOC';

